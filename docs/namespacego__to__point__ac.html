<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>RT2_Assignment1_1: go_to_point_ac Namespace Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">RT2_Assignment1_1
   &#160;<span id="projectnumber">1.0</span>
   </div>
   <div id="projectbrief">first assignment of RT2 course</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">go_to_point_ac Namespace Reference</div>  </div>
</div><!--header-->
<div class="contents">
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a15bb55ed07834652907c67e8e16595b4"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacego__to__point__ac.html#a15bb55ed07834652907c67e8e16595b4">clbk_odom</a> (msg)</td></tr>
<tr class="separator:a15bb55ed07834652907c67e8e16595b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a940704971eda6a08d74b57aa254700d8"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacego__to__point__ac.html#a940704971eda6a08d74b57aa254700d8">change_state</a> (state)</td></tr>
<tr class="separator:a940704971eda6a08d74b57aa254700d8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab36b3cf825a31836c32255018d958591"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacego__to__point__ac.html#ab36b3cf825a31836c32255018d958591">normalize_angle</a> (angle)</td></tr>
<tr class="separator:ab36b3cf825a31836c32255018d958591"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a15849b2e8c4ad71e46836d9023eeba8f"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacego__to__point__ac.html#a15849b2e8c4ad71e46836d9023eeba8f">fix_yaw</a> (des_pos)</td></tr>
<tr class="separator:a15849b2e8c4ad71e46836d9023eeba8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abee9bb9f93efd8a37601b6b52d70c009"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacego__to__point__ac.html#abee9bb9f93efd8a37601b6b52d70c009">go_straight_ahead</a> (des_pos)</td></tr>
<tr class="separator:abee9bb9f93efd8a37601b6b52d70c009"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe41dbe37043beba171300f1ac8257ba"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacego__to__point__ac.html#abe41dbe37043beba171300f1ac8257ba">fix_final_yaw</a> (des_yaw)</td></tr>
<tr class="separator:abe41dbe37043beba171300f1ac8257ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa9d28903c8c0170350e9adae474fab4b"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacego__to__point__ac.html#aa9d28903c8c0170350e9adae474fab4b">done</a> ()</td></tr>
<tr class="separator:aa9d28903c8c0170350e9adae474fab4b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a193e0c0036e9589a185ccf36aab0c4b6"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacego__to__point__ac.html#a193e0c0036e9589a185ccf36aab0c4b6">execute_action</a> (goal)</td></tr>
<tr class="separator:a193e0c0036e9589a185ccf36aab0c4b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a891609c39cbe2e8c67d4d0d9c1babf"><td class="memItemLeft" align="right" valign="top">def&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacego__to__point__ac.html#a3a891609c39cbe2e8c67d4d0d9c1babf">main</a> ()</td></tr>
<tr class="separator:a3a891609c39cbe2e8c67d4d0d9c1babf"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:ae35b6ed44a06f4b5a4cd3c2f1c1b405a"><td class="memItemLeft" align="right" valign="top"><a id="ae35b6ed44a06f4b5a4cd3c2f1c1b405a"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>position_</b> = Point()</td></tr>
<tr class="separator:ae35b6ed44a06f4b5a4cd3c2f1c1b405a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3eb1b86b5c18ed70dc9f596d8abbbaa4"><td class="memItemLeft" align="right" valign="top"><a id="a3eb1b86b5c18ed70dc9f596d8abbbaa4"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>yaw_</b> = 0</td></tr>
<tr class="separator:a3eb1b86b5c18ed70dc9f596d8abbbaa4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a50de3608cdc4794d8759f9423d5ec965"><td class="memItemLeft" align="right" valign="top"><a id="a50de3608cdc4794d8759f9423d5ec965"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>state_</b> = 0</td></tr>
<tr class="separator:a50de3608cdc4794d8759f9423d5ec965"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af108c2eda2e28e7ed8e0911b3678661b"><td class="memItemLeft" align="right" valign="top"><a id="af108c2eda2e28e7ed8e0911b3678661b"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>pub_</b> = None</td></tr>
<tr class="separator:af108c2eda2e28e7ed8e0911b3678661b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59397e8e6acccfd50117e6d0242098f4"><td class="memItemLeft" align="right" valign="top"><a id="a59397e8e6acccfd50117e6d0242098f4"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>action_service</b> = None</td></tr>
<tr class="separator:a59397e8e6acccfd50117e6d0242098f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac72f990695f1b25182736d3ae9b3a4ca"><td class="memItemLeft" align="right" valign="top"><a id="ac72f990695f1b25182736d3ae9b3a4ca"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>feedback_</b> = GoToPointFeedback()</td></tr>
<tr class="separator:ac72f990695f1b25182736d3ae9b3a4ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae4c7412d9e15ee6be411af26e1e1411e"><td class="memItemLeft" align="right" valign="top"><a id="ae4c7412d9e15ee6be411af26e1e1411e"></a>
&#160;</td><td class="memItemRight" valign="bottom"><b>result_</b> = GoToPointResult()</td></tr>
<tr class="separator:ae4c7412d9e15ee6be411af26e1e1411e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30bf04c0f7e7153b57f77eab8e0e216b"><td class="memItemLeft" align="right" valign="top"><a id="a30bf04c0f7e7153b57f77eab8e0e216b"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>yaw_precision_</b> = math.pi / 9</td></tr>
<tr class="separator:a30bf04c0f7e7153b57f77eab8e0e216b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17c89959862d23bf2bfbbf7353c5f5f6"><td class="memItemLeft" align="right" valign="top"><a id="a17c89959862d23bf2bfbbf7353c5f5f6"></a>
int&#160;</td><td class="memItemRight" valign="bottom"><b>yaw_precision_2_</b> = math.pi / 90</td></tr>
<tr class="separator:a17c89959862d23bf2bfbbf7353c5f5f6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa601699599cba598ccd4a8f41f75ccbf"><td class="memItemLeft" align="right" valign="top"><a id="aa601699599cba598ccd4a8f41f75ccbf"></a>
float&#160;</td><td class="memItemRight" valign="bottom"><b>dist_precision_</b> = 0.1</td></tr>
<tr class="separator:aa601699599cba598ccd4a8f41f75ccbf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac99886fe8ab0acc0262b86dfe375f927"><td class="memItemLeft" align="right" valign="top"><a id="ac99886fe8ab0acc0262b86dfe375f927"></a>
float&#160;</td><td class="memItemRight" valign="bottom"><b>kp_a</b> = -3.0</td></tr>
<tr class="separator:ac99886fe8ab0acc0262b86dfe375f927"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad2eb4c7fc01059c159e8e3b3c014efb0"><td class="memItemLeft" align="right" valign="top"><a id="ad2eb4c7fc01059c159e8e3b3c014efb0"></a>
float&#160;</td><td class="memItemRight" valign="bottom"><b>kp_d</b> = 0.2</td></tr>
<tr class="separator:ad2eb4c7fc01059c159e8e3b3c014efb0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2cdd9e78dd2cd8f31282c46bd799d87b"><td class="memItemLeft" align="right" valign="top"><a id="a2cdd9e78dd2cd8f31282c46bd799d87b"></a>
float&#160;</td><td class="memItemRight" valign="bottom"><b>ub_a</b> = 0.6</td></tr>
<tr class="separator:a2cdd9e78dd2cd8f31282c46bd799d87b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afad6bdb3362e979c2a4c5cfb59a4b087"><td class="memItemLeft" align="right" valign="top"><a id="afad6bdb3362e979c2a4c5cfb59a4b087"></a>
float&#160;</td><td class="memItemRight" valign="bottom"><b>lb_a</b> = -0.5</td></tr>
<tr class="separator:afad6bdb3362e979c2a4c5cfb59a4b087"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a641a180845a5f98ad91993c477b127d3"><td class="memItemLeft" align="right" valign="top"><a id="a641a180845a5f98ad91993c477b127d3"></a>
float&#160;</td><td class="memItemRight" valign="bottom"><b>ub_d</b> = 0.6</td></tr>
<tr class="separator:a641a180845a5f98ad91993c477b127d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><pre class="fragment">.. module:: go_to_point_ac.py
   :platform: Unix
   :synopsis: this file is an implementation of go to point action server node
   
.. moduleauthor:: Carmine Recchiuto - Yara Abdelmottaleb
 
This node implements the go to point action server node. 
When an action request is received with a goal position, it drives the robot towards the goal.
It drives the robot in three steps:
- rotating the robot around its z-axis until it is oriented towards the goal point
- going straight ahead until it reaches the goal point
- rotating the robot around its z-axis until it is oriented in the goal orientation
During the three steps, if a cancel request is received through the action server, 
the goal is aborted and the robot stops.
 
Subscribes to:
   /odom
 
Publishes to:
   /cmd_vel
 
Services:
   /go_to_point_ac</pre> </div><h2 class="groupheader">Function Documentation</h2>
<a id="a940704971eda6a08d74b57aa254700d8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a940704971eda6a08d74b57aa254700d8">&#9670;&nbsp;</a></span>change_state()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def go_to_point_ac.change_state </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>state</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">this is change_state function of the robot
This function takes as input the current state value of the robot. 
It updates the global variable state_ accordingly with the current new state

Args:
  state(int): the current state value of the robot (0, 1, 2)</pre> 
</div>
</div>
<a id="a15bb55ed07834652907c67e8e16595b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a15bb55ed07834652907c67e8e16595b4">&#9670;&nbsp;</a></span>clbk_odom()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def go_to_point_ac.clbk_odom </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>msg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">this is the callback function of /odom subscriber
This function receives periodically the current odometry of the robot. 
It stores the position in the global variable position_
It converts the orientation from quaternion to Euler representation and stores the yaw angle in global variable yaw_

Args:
  msg(Odomoetry): the current odometry of the robot received through the topic /odom. </pre> 
</div>
</div>
<a id="aa9d28903c8c0170350e9adae474fab4b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa9d28903c8c0170350e9adae474fab4b">&#9670;&nbsp;</a></span>done()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def go_to_point_ac.done </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">This function is responsible for stopping the robot
This function is responsible for stopping the robot after reaching the goal, or when the goal is cancelled.
It publishes a zero velocity msg to the robot to stop it</pre> 
</div>
</div>
<a id="a193e0c0036e9589a185ccf36aab0c4b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a193e0c0036e9589a185ccf36aab0c4b6">&#9670;&nbsp;</a></span>execute_action()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def go_to_point_ac.execute_action </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>goal</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">This is the callback function of /go_to_point_ac action service
This function takes as input the goal request (x, y, theta). It initializes the robot state to 0.
Then, it loops until the goal position is reached or it is preempted.
In each loop, it does the following:
- it checks if a cancel request has been sent. If yes, it cancels the goal, stops the robot, and break from the loop.
- it publishes the current robot's position as a feedback of the action service
- it checks the current state of the robot and based on each state, it calls the appropriate function to drive the robot towards the goal.
- When the goal is reached, it stops the robot and sets the action result

Args:
  goal(Point): the requested goal position
  
Returns:
  always true</pre> 
</div>
</div>
<a id="abe41dbe37043beba171300f1ac8257ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe41dbe37043beba171300f1ac8257ba">&#9670;&nbsp;</a></span>fix_final_yaw()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def go_to_point_ac.fix_final_yaw </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>des_yaw</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">This function is responsible for orienting the robot's yaw angle in the final goal orientation
This function takes as input the goal angle. It calculates the error angle needed to be oriented in the desired angle
It, then, publishes angular twist msg to the robot to be rotated around the z-axis. 
It checks that the angular velocity msg is in the range between lower and upper bounds.
If the error angle to the goal is less than the precision threshold, it changes the state to 3 to indicate finishing the rotation step

Args:
  des_yaw(float): the desired yaw angle of the goal</pre> 
</div>
</div>
<a id="a15849b2e8c4ad71e46836d9023eeba8f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a15849b2e8c4ad71e46836d9023eeba8f">&#9670;&nbsp;</a></span>fix_yaw()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def go_to_point_ac.fix_yaw </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>des_pos</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">This function is responsible for orienting the robot's yaw angle towards the goal point
This function takes as input the goal point. It calculates the error angle needed to be oriented towards the goal.
It, then, publishes angular twist msg to the robot to be rotated around the z-axis. 
It checks that the angular velocity msg is in the range between lower and upper bounds.
If the error yaw angle to the goal is less than the precision threshold, it changes the state to 1 to indicate finishing the rotation step

Args:
  des_pos(Point): the desired position of the goal</pre> 
</div>
</div>
<a id="abee9bb9f93efd8a37601b6b52d70c009"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abee9bb9f93efd8a37601b6b52d70c009">&#9670;&nbsp;</a></span>go_straight_ahead()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def go_to_point_ac.go_straight_ahead </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>des_pos</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">This function is responsible for driving the robot straight towards a goal position
This function takes as input the desired goal position. It calcualates the error in distance between the current position and the goal.
If the distance error is greater than the distance precision threshold, it publishes a Twist msg with a linear velocity to the robot. 
When the distance error is less than the threshold, it changes the state to 2 to indicate finishing the go_straight_ahead step

Args:
  des_pos(Point): the desired goal position</pre> 
</div>
</div>
<a id="a3a891609c39cbe2e8c67d4d0d9c1babf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a891609c39cbe2e8c67d4d0d9c1babf">&#9670;&nbsp;</a></span>main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def go_to_point_ac.main </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">This is the main function of the node
It initializes the node handle, the publisher to /cmd_vel topic
the subscriber to /odom, and the action server of /go_to_point_ac service.
It assigns the function execute_action as a callback function to the action server</pre> 
</div>
</div>
<a id="ab36b3cf825a31836c32255018d958591"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab36b3cf825a31836c32255018d958591">&#9670;&nbsp;</a></span>normalize_angle()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">def go_to_point_ac.normalize_angle </td>
          <td>(</td>
          <td class="paramtype">&#160;</td>
          <td class="paramname"><em>angle</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<pre class="fragment">This function normalizes the angle to be in the range from -pi to pi
This function takes as input an angle expressed in randians. It checks if this angle is in the range of -pi to pi
If it is not, the function normalizes the angle to be in the range.

Args:
  angle(float): the requested angle to be normalized

Returns:
  the normalized angle</pre> 
</div>
</div>
</div><!-- contents -->
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
